agg_i <- aggregate(data_i$Agegroup, by=list(data_i$Agegroup), FUN=length)
agg_i %>%
rename("n" = "x") %>%
rename("Agegroup" = "Group.1") %>%
group_by(Agegroup) %>%
summarise(n = n()) %>%
mutate(freq = n / sum(n))
agg_i %>%
rename("n" = "x") %>%
rename("Agegroup" = "Group.1") %>%
group_by(Agegroup) %>%
#summarise(n = n()) %>%
mutate(freq = n / sum(n))
##Create matrix for proportion of infections by age group
#Extract age groups column from infections data frame
agg_i <- aggregate(data_i$Agegroup, by=list(data_i$Agegroup), FUN=length)
##Create matrix for proportion of infections by age group
#Extract age groups column from infections data frame
agg_i <- aggregate(data_i$Agegroup, by=list(data_i$Agegroup), FUN=length)
test <- agg_i %>%
rename("n" = "x") %>%
rename("Agegroup" = "Group.1") %>%
group_by(Agegroup) %>%
#summarise(n = n()) %>%
mutate(freq = n / sum(n))
View(agg_i)
View(agg_i)
View(test)
View(test)
4008/51568
test <- data %>%
rename("Count" = "x") %>%
rename("Agegroup" = "Group.1") %>%
group_by(Agegroup) %>%
mutate(Sum = sum(Count)) %>%
mutate(per=paste0(round(100*Count/Sum,2),'%'))
##Create matrix for proportion of infections by age group
#Extract age groups column from infections data frame
agg_i <- aggregate(data_i$Agegroup, by=list(data_i$Agegroup), FUN=length)
test <- data %>%
rename("Count" = "x") %>%
rename("Agegroup" = "Group.1") %>%
group_by(Agegroup) %>%
mutate(Sum = sum(Count)) %>%
mutate(per=paste0(round(100*Count/Sum,2),'%'))
##Create matrix for proportion of infections by age group
#Extract age groups column from infections data frame
agg_i <- aggregate(data_i$Agegroup, by=list(data_i$Agegroup), FUN=length)
test <- agg_i %>%
rename("Count" = "x") %>%
rename("Agegroup" = "Group.1") %>%
group_by(Agegroup) %>%
mutate(Sum = sum(Count)) %>%
mutate(per=paste0(round(100*Count/Sum,2),'%'))
View(test)
View(test)
sum(agg_i$x)
test <- agg_i %>%
rename("Count" = "x") %>%
rename("Agegroup" = "Group.1") %>%
group_by(Agegroup) %>%
mutate(Sum = sum(Count)) %>%
mutate(per=(round(100*Count/Sum,2)))
agg_i %>% sum(Count)
test %>% sum(Count)
sum(test$Count)
test <- agg_i %>%
rename("Count" = "x") %>%
rename("Agegroup" = "Group.1") %>%
group_by(Agegroup) %>%
mutate(Sum = sum(test$Count)) %>%
mutate(per=(round(100*Count/Sum,2)))
##Create matrix for proportion of infections by age group
#Extract age groups column from infections data frame
agg_i <- aggregate(data_i$Agegroup, by=list(data_i$Agegroup), FUN=length)
agg_i <- agg_i %>%
rename("Count" = "x") %>%
rename("Agegroup" = "Group.1") %>%
group_by(Agegroup) %>%
mutate(Sum = sum(agg_i$Count)) %>%
mutate(Proportion = Count/Sum)
View(agg_i)
agg_i <- agg_i %>%
rename("Count" = "x") %>%
rename("Agegroup" = "Group.1") %>%
group_by(Agegroup) %>%
mutate(Sum = sum(agg_i$Count)) #%>%
##Create matrix for proportion of infections by age group
#Extract age groups column from infections data frame
agg_i <- aggregate(data_i$Agegroup, by=list(data_i$Agegroup), FUN=length)
agg_i <- agg_i %>%
rename("Count" = "x") %>%
rename("Agegroup" = "Group.1") %>%
group_by(Agegroup) %>%
mutate(Sum = sum(agg_i$Count)) #%>%
##Create matrix for proportion of infections by age group
#Extract age groups column from infections data frame
agg_i <- aggregate(data_i$Agegroup, by=list(data_i$Agegroup), FUN=length)
agg_i <- agg_i %>%
rename("Count" = "x") %>%
rename("Agegroup" = "Group.1") %>%
group_by(Agegroup) %>%
mutate(Sum = sum(agg_i$Count)) %>%
mutate(per=(round(100*Count/Sum,2)))
##Create matrix for proportion of infections by age group
#Extract age groups column from infections data frame
agg_i <- aggregate(data_i$Agegroup, by=list(data_i$Agegroup), FUN=length)
test <- agg_i %>%
rename("Count" = "x") %>%
rename("Agegroup" = "Group.1") %>%
group_by(Agegroup) %>%
mutate(Sum = sum(test$Count)) %>%
mutate(per=(round(100*Count/Sum,2)))
##Create matrix for proportion of infections by age group
#Extract age groups column from infections data frame
agg_i <- aggregate(data_i$Agegroup, by=list(data_i$Agegroup), FUN=length)
##Create matrix for proportion of infections by age group
#Extract age groups column from infections data frame
agg_i <- aggregate(data_i$Agegroup, by=list(data_i$Agegroup), FUN=length)
test <- agg_i %>%
rename("Count" = "x") %>%
rename("Agegroup" = "Group.1") %>%
group_by(Agegroup) %>%
mutate(Sum = sum(test$Count)) %>%
mutate(per=(Count/Sum,2))
##Create matrix for proportion of infections by age group
#Extract age groups column from infections data frame
agg_i <- aggregate(data_i$Agegroup, by=list(data_i$Agegroup), FUN=length)
##Create matrix for proportion of infections by age group
#Extract age groups column from infections data frame
agg_i <- aggregate(data_i$Agegroup, by=list(data_i$Agegroup), FUN=length)
test <- agg_i %>%
rename("Count" = "x") %>%
rename("Agegroup" = "Group.1") %>%
group_by(Agegroup) %>%
mutate(Sum = sum(test$Count)) %>%
mutate(per=(Count/Sum))
##Create matrix for proportion of infections by age group
#Extract age groups column from infections data frame
agg_i <- aggregate(data_i$Agegroup, by=list(data_i$Agegroup), FUN=length)
##Create matrix for proportion of infections by age group
#Extract age groups column from infections data frame
agg_i <- aggregate(data_i$Agegroup, by=list(data_i$Agegroup), FUN=length)
test <- agg_i %>%
rename("Count" = "x") %>%
rename("Agegroup" = "Group.1") %>%
group_by(Agegroup) %>%
mutate(Sum = sum(test$Count)) %>%
mutate(per=(round(Count/Sum,2)))
##Create matrix for proportion of infections by age group
#Extract age groups column from infections data frame
agg_i <- aggregate(data_i$Agegroup, by=list(data_i$Agegroup), FUN=length)
test <- agg_i %>%
rename("Count" = "x") %>%
rename("Agegroup" = "Group.1") %>%
group_by(Agegroup) %>%
mutate(Sum = sum(test$Count)) %>%
mutate(per=(round(Count/Sum,4)))
##Create matrix for proportion of infections by age group
#Extract age groups column from infections data frame
agg_i <- aggregate(data_i$Agegroup, by=list(data_i$Agegroup), FUN=length)
agg_i <- agg_i %>%
rename("Count" = "x") %>%
rename("Agegroup" = "Group.1") %>%
group_by(Agegroup) %>%
mutate(Sum = sum(agg_i$x)) %>%
mutate(per=(round(Count/Sum,4)))
##Create matrix for proportion of infections by age group
#Extract age groups column from infections data frame
agg_i <- aggregate(data_i$Agegroup, by=list(data_i$Agegroup), FUN=length)
agg_i <- agg_i %>%
rename("Count" = "x") %>%
rename("Agegroup" = "Group.1") %>%
group_by(Agegroup) %>%
mutate(Sum = sum(agg_i$x)) %>%
mutate(Proportion=(round(Count/Sum,4)))
#Diagonal matrix
diag_i <- Diagonal(count(agg_i), agg_i$Count)
library(ISLR)
library(dplyr)
library(tidyverse)
library(haven)
library(readxl)
library(Matrix)
library(tinytex)
library(ggplot2)
library(wesanderson)
data <- read.csv(unz("../data/30-11-2020.zip", "30-11-2020.csv"), header = TRUE)
class <- lapply(data,class)
#Create data frame for infection rate, hence '_i'
#Mutate 'Agegroup' to fix the formatting issue
#Mutate a further two times to plot values in order later
data_i <- data %>%
filter(Agegroup != "Unknown") %>%
filter(Agegroup != "<50") %>%
filter(Sex != "Unknown") %>%
mutate(Agegroup=recode(Agegroup, `Oct-19` = '10-19')) %>%
mutate(Agegroup = as.character(Agegroup)) %>%
mutate(Agegroup = as.factor(Agegroup))
#Create data frame for death rate, hence '_d'
data_d <- data %>%
filter(Agegroup != "Unknown") %>%
filter(Sex != "Unknown") %>%
filter(!is.na(Week_of_death))
#Plot the number of infections using 'data_i' data frame
data_i %>%
arrange(Agegroup) %>%
group_by(Province) %>%
ggplot(aes(x=Province)) +
#guides(col=FALSE) +
geom_bar(mapping = aes(fill = Agegroup), alpha=0.9, position = position_stack(reverse = TRUE)) +
scale_fill_manual(values = wes_palette("Zissou1", 10, type = "continuous")) +
coord_flip() +
theme_classic() +
labs(x="Province", y="Count",
title="Infection by Age Group")
#Plot the numbe of deaths using the 'data_d' data frame
data_d %>%
group_by(Province) %>%
ggplot(aes(x=Province)) +
#guides(col=FALSE) +
geom_bar(mapping = aes(fill = Agegroup), alpha=0.9, position = position_stack(reverse = TRUE)) +
scale_fill_manual(values = wes_palette("Zissou1", 6, type = "continuous")) +
coord_flip() +
theme_classic() +
labs(x="Province", y="Count",
title="Death by Age Group")
##Create matrix for proportion of infections by age group
#Extract age groups column from infections data frame
agg_i <- aggregate(data_i$Agegroup, by=list(data_i$Agegroup), FUN=length)
agg_i <- agg_i %>%
rename("Count" = "x") %>%
rename("Agegroup" = "Group.1") %>%
group_by(Agegroup) %>%
mutate(Sum = sum(agg_i$x)) %>%
mutate(Proportion=(round(Count/Sum,4)))
#Diagonal matrix
diag_i <- Diagonal(count(agg_i), agg_i$Count)
count(agg_i)
#Diagonal matrix
diag_i <- Diagonal(count(agg_i$Agegroup), agg_i$Count)
View(agg_i)
Diagonal(count(agg_i$Agegroup), agg_i$Count)
Diagonal(count(agg_i), agg_i$Count)
help("Diagonal")
n <- count(agg_i$Agegroup)
lapply(agg_i, class)
nrow(agg_i)
#Diagonal matrix
diag_i <- Diagonal(nrow(agg_i), agg_i$Count)
##Create matrix for proportion of infections by age group
#Extract age groups column from infections data frame
agg_i <- aggregate(data_i$Agegroup, by=list(data_i$Agegroup), FUN=length)
agg_i <- agg_i %>%
rename("Count" = "x") %>%
rename("Agegroup" = "Group.1") %>%
group_by(Agegroup) %>%
mutate(Sum = sum(agg_i$x)) %>%
mutate(Proportion=(round(Count/Sum,4)))
n <- count(agg_i$Agegroup)
##Create matrix for proportion of infections by age group
#Extract age groups column from infections data frame
agg_i <- aggregate(data_i$Agegroup, by=list(data_i$Agegroup), FUN=length)
agg_i <- agg_i %>%
rename("Count" = "x") %>%
rename("Agegroup" = "Group.1") %>%
group_by(Agegroup) %>%
mutate(Sum = sum(agg_i$x)) %>%
mutate(Proportion=(round(Count/Sum,4)))
#Diagonal matrix
diag_i <- Diagonal(nrow(agg_i), agg_i$Count)
##Create matrix for proportion of deaths by age group
#Extract age groups column from death rate data frame
agg_d <- aggregate(data_d$Agegroup, by=list(data_d$Agegroup), FUN=length)
agg_d <- agg_d %>%
rename("Count" = "x") %>%
rename("Agegroup" = "Group.1") %>%
group_by(Agegroup) %>%
mutate(Sum = sum(agg_i$x)) %>%
mutate(Proportion=(round(Count/Sum,4)))
agg_d <- agg_d %>%
rename("Count" = "x") %>%
rename("Agegroup" = "Group.1")
##Create matrix for proportion of infections by age group
#Extract age groups column from infections data frame
agg_i <- aggregate(data_i$Agegroup, by=list(data_i$Agegroup), FUN=length)
agg_i <- agg_i %>%
rename("Count" = "x") %>%
rename("Agegroup" = "Group.1") %>%
group_by(Agegroup) %>%
mutate(Sum = sum(agg_i$x)) %>%
mutate(Proportion=(round(Count/Sum,4)))
#Diagonal matrix
diag_i <- Diagonal(nrow(agg_i), agg_i$Count)
##Create matrix for proportion of deaths by age group
#Extract age groups column from death rate data frame
agg_d <- aggregate(data_d$Agegroup, by=list(data_d$Agegroup), FUN=length)
agg_d <- agg_d %>%
rename("Count" = "x") %>%
rename("Agegroup" = "Group.1") %>%
group_by(Agegroup) %>%
mutate(Sum = sum(agg_i$x)) %>%
mutate(Proportion=(round(Count/Sum,4)))
diag_d <- Diagonal(nrow(agg_d), agg_d$Count)
library(ISLR)
library(dplyr)
library(tidyverse)
library(haven)
library(readxl)
library(Matrix)
library(tinytex)
library(ggplot2)
library(wesanderson)
data <- read.csv(unz("../data/30-11-2020.zip", "30-11-2020.csv"), header = TRUE)
class <- lapply(data,class)
#Create data frame for infection rate, hence '_i'
#Mutate 'Agegroup' to fix the formatting issue
#Mutate a further two times to plot values in order later
data_i <- data %>%
filter(Agegroup != "Unknown") %>%
filter(Agegroup != "<50") %>%
filter(Sex != "Unknown") %>%
mutate(Agegroup=recode(Agegroup, `Oct-19` = '10-19')) %>%
mutate(Agegroup = as.character(Agegroup)) %>%
mutate(Agegroup = as.factor(Agegroup))
#Create data frame for death rate, hence '_d'
data_d <- data %>%
filter(Agegroup != "Unknown") %>%
filter(Sex != "Unknown") %>%
filter(!is.na(Week_of_death))
#Plot the number of infections using 'data_i' data frame
data_i %>%
arrange(Agegroup) %>%
group_by(Province) %>%
ggplot(aes(x=Province)) +
#guides(col=FALSE) +
geom_bar(mapping = aes(fill = Agegroup), alpha=0.9, position = position_stack(reverse = TRUE)) +
scale_fill_manual(values = wes_palette("Zissou1", 10, type = "continuous")) +
coord_flip() +
theme_classic() +
labs(x="Province", y="Count",
title="Infection by Age Group")
#Plot the numbe of deaths using the 'data_d' data frame
data_d %>%
group_by(Province) %>%
ggplot(aes(x=Province)) +
#guides(col=FALSE) +
geom_bar(mapping = aes(fill = Agegroup), alpha=0.9, position = position_stack(reverse = TRUE)) +
scale_fill_manual(values = wes_palette("Zissou1", 6, type = "continuous")) +
coord_flip() +
theme_classic() +
labs(x="Province", y="Count",
title="Death by Age Group")
##Create matrix for proportion of infections by age group
#Extract age groups column from infections data frame
agg_i <- aggregate(data_i$Agegroup, by=list(data_i$Agegroup), FUN=length)
agg_i <- agg_i %>%
rename("Count" = "x") %>%
rename("Agegroup" = "Group.1") %>%
group_by(Agegroup) %>%
mutate(Sum = sum(agg_i$x)) %>%
mutate(Proportion=(round(Count/Sum,4)))
#Diagonal matrix
diag_i <- Diagonal(nrow(agg_i), agg_i$Count)
##Create matrix for proportion of deaths by age group
#Extract age groups column from death rate data frame
agg_d <- aggregate(data_d$Agegroup, by=list(data_d$Agegroup), FUN=length)
agg_d <- agg_d %>%
rename("Count" = "x") %>%
rename("Agegroup" = "Group.1") %>%
group_by(Agegroup) %>%
mutate(Sum = sum(agg_i$x)) %>%
mutate(Proportion=(round(Count/Sum,4)))
diag_d <- Diagonal(nrow(agg_d), agg_d$Count)
diag_d
View(agg_d)
View(agg_d)
agg_d <- agg_d %>%
rename("Count" = "x") %>%
rename("Agegroup" = "Group.1") %>%
group_by(Agegroup) %>%
mutate(Sum = sum(agg_d$x)) %>%
mutate(Proportion=(round(Count/Sum,4)))
##Create matrix for proportion of infections by age group
#Extract age groups column from infections data frame
agg_i <- aggregate(data_i$Agegroup, by=list(data_i$Agegroup), FUN=length)
agg_i <- agg_i %>%
rename("Count" = "x") %>%
rename("Agegroup" = "Group.1") %>%
group_by(Agegroup) %>%
mutate(Sum = sum(agg_i$x)) %>%
mutate(Proportion=(round(Count/Sum,4)))
#Diagonal matrix
diag_i <- Diagonal(nrow(agg_i), agg_i$Count)
##Create matrix for proportion of deaths by age group
#Extract age groups column from death rate data frame
agg_d <- aggregate(data_d$Agegroup, by=list(data_d$Agegroup), FUN=length)
agg_d <- agg_d %>%
rename("Count" = "x") %>%
rename("Agegroup" = "Group.1") %>%
group_by(Agegroup) %>%
mutate(Sum = sum(agg_d$x)) %>%
mutate(Proportion=(round(Count/Sum,4)))
diag_d <- Diagonal(nrow(agg_d), agg_d$Count)
diag_d
#Diagonal matrix for proportion of infections
diag_i_prop <- Diagonal(nrow(agg_i), agg_i$Proportion)
diag_i_prop
#Diagonal matrix for proportion of deaths
diag_d_prop <- Diagonal(nrow(agg_d), agg_d$Proportion)
library(ISLR)
library(dplyr)
library(tidyverse)
library(haven)
library(readxl)
library(Matrix)
library(tinytex)
library(ggplot2)
library(wesanderson)
data <- read.csv(unz("../data/30-11-2020.zip", "30-11-2020.csv"), header = TRUE)
Contact_matrix <- read.csv("../data/Contact_matrix.csv", header = TRUE)
class <- lapply(data,class)
##Build contact matrix for the physical&non-physical contact of people in different age-groups in the Netherlands, taken from https://journals.plos.org/plosmedicine/article?id=10.1371/journal.pmed.0050074
Contact_matrix <- Contact_matrix %>%
rename("0_4" = 1, "5_9" = 2, "10_14" = 3, "15_19" = 4, "20_24" = 5, "25_29" = 6, "30_34" = 7, "35_39" = 8, "40_44" = 9, "45_49" = 10, "50_54" = 11, "55_59" = 12, "60_64" = 13, "65_69" = 14, "70+" = 15)
#Create data frame for infection rate, hence '_i'
#Mutate 'Agegroup' to fix the formatting issue
#Mutate a further two times to plot values in order later
data_i <- data %>%
filter(Agegroup != "Unknown") %>%
filter(Agegroup != "<50") %>%
filter(Sex != "Unknown") %>%
mutate(Agegroup=recode(Agegroup, `Oct-19` = '10-19')) %>%
mutate(Agegroup = as.character(Agegroup)) %>%
mutate(Agegroup = as.factor(Agegroup))
#Create data frame with infections of last 10 days
data_i10 <- data %>%
filter(Date_statistics == c("31/10/2020", "30/10/2020", "29/10/2020", "28/10/2020", "27/10/2020", "26/10/2020", "25/10/2020", "24/10/2020", "23/10/2020", "22/10/2020")) %>%
filter(Agegroup != "Unknown") %>%
filter(Agegroup != "<50") %>%
filter(Sex != "Unknown") %>%
mutate(Agegroup=recode(Agegroup, `Oct-19` = '10-19')) %>%
mutate(Agegroup = as.character(Agegroup)) %>%
mutate(Agegroup = as.factor(Agegroup))
#Create data frame for death rate, hence '_d'
data_d <- data %>%
filter(Agegroup != "Unknown") %>%
filter(Sex != "Unknown") %>%
filter(!is.na(Week_of_death))
#Plot the number of infections using 'data_i' data frame
data_i %>%
arrange(Agegroup) %>%
group_by(Province) %>%
ggplot(aes(x=Province)) +
#guides(col=FALSE) +
geom_bar(mapping = aes(fill = Agegroup), alpha=0.9, position = position_stack(reverse = TRUE)) +
scale_fill_manual(values = wes_palette("Zissou1", 10, type = "continuous")) +
coord_flip() +
theme_classic() +
labs(x="Province", y="Count",
title="Infection by Age Group")
View(Contact_matrix)
View(Contact_matrix)
#Plot the numbe of deaths using the 'data_d' data frame
data_d %>%
group_by(Province) %>%
ggplot(aes(x=Province)) +
#guides(col=FALSE) +
geom_bar(mapping = aes(fill = Agegroup), alpha=0.9, position = position_stack(reverse = TRUE)) +
scale_fill_manual(values = wes_palette("Zissou1", 6, type = "continuous")) +
coord_flip() +
theme_classic() +
labs(x="Province", y="Count",
title="Death by Age Group")
##Create matrix for proportion of infections by age group
#Extract age groups column from infections data frame
agg_i <- aggregate(data_i$Agegroup, by=list(data_i$Agegroup), FUN=length)
agg_i <- agg_i %>%
rename("Count" = "x") %>%
rename("Agegroup" = "Group.1") %>%
group_by(Agegroup) %>%
mutate(Sum = sum(agg_i$x)) %>%
mutate(Proportion=(round(Count/Sum,4)))
#Diagonal matrix
diag_i <- Diagonal(nrow(agg_i), agg_i$Count)
#Diagonal matrix for proportion of infections
diag_i_prop <- Diagonal(nrow(agg_i), agg_i$Proportion)
##Create matrix for proportion of deaths by age group
#Extract age groups column from death rate data frame
agg_d <- aggregate(data_d$Agegroup, by=list(data_d$Agegroup), FUN=length)
agg_d <- agg_d %>%
rename("Count" = "x") %>%
rename("Agegroup" = "Group.1") %>%
group_by(Agegroup) %>%
mutate(Sum = sum(agg_d$x)) %>%
mutate(Proportion=(round(Count/Sum,4)))
#Diagonal matrix
diag_d <- Diagonal(nrow(agg_d), agg_d$Count)
#Diagonal matrix for proportion of deaths
diag_d_prop <- Diagonal(nrow(agg_d), agg_d$Proportion)
agg_i10 <- aggregate(data_i10$Agegroup, by=list(data_i10$Agegroup), FUN=length)
agg_i10 <- agg_i10 %>%
rename("Count" = "x") %>%
rename("Agegroup" = "Group.1") %>%
group_by(Agegroup) %>%
mutate(Sum = sum(agg_i10$x)) %>%
mutate(Proportion=(round(Count/Sum,4)))
#agg_i10 = I_zero
#Now construct R_0 from agg_i and agg_i10
R0 = (agg_i$Count - agg_i10$Count)
#Now scale by randomized testing
#Extract data from papers
